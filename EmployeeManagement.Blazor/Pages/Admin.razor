@page "/admin"
@using Microsoft.AspNetCore.Authorization
@using System.Security.Claims
@* @attribute [Authorize(Roles = "admin")] *@

<AuthorizeView Roles="admin">
    <Authorized>
        <h3>Admin Page</h3>
        <p>
            Welcome, you have access to the Admin page!
            IsInRole("admin") = @currentUser.IsInRole("admin")
        </p>
        <ul>
            @foreach (var claim in currentUser.Claims)
            {
                <li>@claim.Type : @claim.Value</li>
            }
        </ul>
    </Authorized>
    <NotAuthorized>
        <p>Bạn không có quyền truy cập trang này. Vui lòng đăng nhập với tài khoản Admin.</p>
        <a href="/login">Login</a>
    </NotAuthorized>
</AuthorizeView>
@code {
    private ClaimsPrincipal currentUser = new();

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        currentUser = authState.User;
    }

    [Inject]
    public AuthenticationStateProvider AuthenticationStateProvider { get; set; } = default!;
}
